{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport { BaseWalletAdapter } from './adapter';\nimport { WalletError, WalletSendTransactionError } from './errors';\nexport class BaseSignerWalletAdapter extends BaseWalletAdapter {\n  sendTransaction(transaction, connection) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return __awaiter(this, void 0, void 0, function* () {\n      let emit = true;\n\n      try {\n        try {\n          transaction.feePayer || (transaction.feePayer = this.publicKey || undefined);\n          transaction.recentBlockhash || (transaction.recentBlockhash = (yield connection.getRecentBlockhash('finalized')).blockhash);\n\n          const {\n            signers\n          } = options,\n                sendOptions = __rest(options, [\"signers\"]);\n\n          (signers === null || signers === void 0 ? void 0 : signers.length) && transaction.partialSign(...signers);\n          transaction = yield this.signTransaction(transaction);\n          const rawTransaction = transaction.serialize();\n          return yield connection.sendRawTransaction(rawTransaction, sendOptions);\n        } catch (error) {\n          // If the error was thrown by `signTransaction`, rethrow it and don't emit a duplicate event\n          if (error instanceof WalletError) {\n            emit = false;\n            throw error;\n          }\n\n          throw new WalletSendTransactionError(error === null || error === void 0 ? void 0 : error.message, error);\n        }\n      } catch (error) {\n        if (emit) {\n          this.emit('error', error);\n        }\n\n        throw error;\n      }\n    });\n  }\n\n}\nexport class BaseMessageSignerWalletAdapter extends BaseSignerWalletAdapter {}","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,SAASA,iBAAT,QAAyE,WAAzE;AACA,SAASC,WAAT,EAAsBC,0BAAtB,QAAwD,UAAxD;AASA,OAAM,MAAgBC,uBAAhB,SAAgDH,iBAAhD,CAAiE;AAC7DI,iBAAe,CACjBC,WADiB,EAEjBC,UAFiB,EAGmB;AAAA,QAApCC,OAAoC,uEAAF,EAAE;;AAEpC,UAAIC,IAAI,GAAG,IAAX;;AACA,UAAI;AACA,YAAI;AACAH,qBAAW,CAACI,QAAZ,gBAAW,CAACA,QAAZ,GAAyB,KAAKC,SAAL,IAAkBC,SAA3C;AACAN,qBAAW,CAACO,eAAZ,gBAAW,CAACA,eAAZ,GAAgC,CAAC,MAAMN,UAAU,CAACO,kBAAX,CAA8B,WAA9B,CAAP,EAAmDC,SAAnF;;AAEA,gBAAM;AAAEC;AAAF,cAA8BR,OAApC;AAAA,gBAAoBS,WAAW,UAAKT,OAAL,EAAzB,WAAyB,CAA/B;;AAEA,kBAAO,SAAP,WAAO,WAAP,GAAO,MAAP,UAAO,CAAEU,MAAT,KAAmBZ,WAAW,CAACa,WAAZ,CAAwB,GAAGH,OAA3B,CAAnB;AAEAV,qBAAW,GAAG,MAAM,KAAKc,eAAL,CAAqBd,WAArB,CAApB;AAEA,gBAAMe,cAAc,GAAGf,WAAW,CAACgB,SAAZ,EAAvB;AAEA,iBAAO,MAAMf,UAAU,CAACgB,kBAAX,CAA8BF,cAA9B,EAA8CJ,WAA9C,CAAb;AACH,SAbD,CAaE,OAAOO,KAAP,EAAmB;AACjB;AACA,cAAIA,KAAK,YAAYtB,WAArB,EAAkC;AAC9BO,gBAAI,GAAG,KAAP;AACA,kBAAMe,KAAN;AACH;;AACD,gBAAM,IAAIrB,0BAAJ,CAA+BqB,KAAK,SAAL,SAAK,WAAL,GAAK,MAAL,QAAK,CAAEC,OAAtC,EAA+CD,KAA/C,CAAN;AACH;AACJ,OAtBD,CAsBE,OAAOA,KAAP,EAAmB;AACjB,YAAIf,IAAJ,EAAU;AACN,eAAKA,IAAL,CAAU,OAAV,EAAmBe,KAAnB;AACH;;AACD,cAAMA,KAAN;AACH;AACJ;AAAA;;AAnCkE;AA+CvE,OAAM,MAAgBE,8BAAhB,SACMtB,uBADN,CAC6B","names":["BaseWalletAdapter","WalletError","WalletSendTransactionError","BaseSignerWalletAdapter","sendTransaction","transaction","connection","options","emit","feePayer","publicKey","undefined","recentBlockhash","getRecentBlockhash","blockhash","signers","sendOptions","length","partialSign","signTransaction","rawTransaction","serialize","sendRawTransaction","error","message","BaseMessageSignerWalletAdapter"],"sourceRoot":"","sources":["../src/signer.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}